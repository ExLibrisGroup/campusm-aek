log = require("../logger")
_ = require("lodash")
path = require("path")
spawn = require("cross-spawn")


getGulp = ()->
  gulp = require("../gulp")
  if gulp
    return gulp

  log.error "Gulp could not be loaded. Please ensure that a gulpfile exists in you working directory and it includes 'module.exports=gulp'"
  process.exit()


module.exports =
  name:"task"
  help:"Execute Gulp Task"
  options:[
    {
      name:"name"
      position:1
      promptIfMissing:true
      choices:(opts)->
        gulp = getGulp()
        _.keys(gulp.tasks)
    }
  ]
    
  callback:(options)->
    child = spawn("gulp",[options.name],stdio:'inherit')

  