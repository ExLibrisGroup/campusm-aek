
_ = require("lodash")
Promise = require("rsvp").Promise
prompt = require("cli-prompt")

module.exports =
  runAsync:(func,cb,args...)->
    async = false
    result = func.apply
      async:()->
        async = true
        return _.once(cb)
      ,Array.prototype.slice.call(arguments, 2)
    
    if (!async)
      cb(result)

  runPromise:(func,args...)->
    if _.isFunction(func)
      return new Promise (resolve,reject)->
        async = false
        result = func.apply
          async:()->
            async=true
            return resolve
          ,args
        if !async
          resolve(result)
    else
      return Promise.resolve(func)

  prompt:prompt