var React = require("react");
var utils = require("../../utils");
var mergeProps = require("../utils/merge-props");
var pickHtmlProps = require("../utils/pick-html-props");

var Checkbox = React.createClass({

  getDefaultProps: function() {
    return {
      checkedValue: true,
      uncheckedValue: false
    };
  },

  onChange:function(e) {
    var onChange = this.props.onChange || this.inputProps.onChange;
    if(onChange) {

      var input = e.target,
          name = e.target && e.target.name || null,
          value = (input || null) && input.checked;

      if(value===true) {
        value = this.props.checkedValue;
      }
      else if(value===false) {
        value = this.props.uncheckedValue;
      }

      onChange(e,name,value);

    }

  },


  render: function() {

    var props = this.props;
    var id = props.id;
    var containerProps = {classSet:{ui:true,checkbox:true}};

    if(!id) {
      if(!this.id) {
        this.id = utils.uniqueId("checkbox_");
      }
      id = this.id;
    }

    var inputProps = utils.extend({id:id,name:props.name,type:"checkbox"},props,{onChange:this.onChange,value:null,type:"checkbox"});

    var className = "ui checkbox";

    if(props.checkboxType) {
      containerProps.classSet[props.checkboxType] = true;
    }

    containerProps = mergeProps(containerProps,props.containerProps);

    inputProps.checked = props.checked || props.value === props.checkedValue;

    if (inputProps.value === null) { inputProps.value = undefined; }

    return (
      <div className={className} {...pickHtmlProps(containerProps)}>
        <input {...pickHtmlProps(inputProps,{exclude:["children"]})}/>
        <label htmlFor={id}>{props.label}</label>
      </div>
    );
  }
});

var Slider = React.createClass({
  render:function() {
    return <Checkbox checkboxType="slider" {...this.props}/>;
  }
});

var Toggle = React.createClass({
  render:function() {
    return <Checkbox checkboxType="toggle" {...this.props} />;
  }
});

Checkbox.Checkbox = Checkbox;
Checkbox.Toggle = Toggle;
Checkbox.Slider = Slider;


module.exports = Checkbox;
