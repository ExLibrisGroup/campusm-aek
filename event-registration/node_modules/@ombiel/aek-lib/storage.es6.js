var data = {};

class AekStorage {

  constructor(name) {
    this.key = "_aek_store_" + name;
  }

  get(key) {

    var fullKey = this.key + "__" + key;
    var str;

    try {
      str = window.localStorage[fullKey];
    }
    catch(e) {
      try {
        str = window.sessionStorage[fullKey];
      }
      catch(e) {
        str = data[fullKey];
      }
    }

    if(str) {
      var val;
      try {
        val = JSON.parse(str);
      }
      catch(e) {} //eslint-disable-line no-empty

      return val;
    }

    return null;
  }

  set(key,value) {

    var fullKey = this.key + "__" + key;
    var str = JSON.stringify(value);
    try {
      window.localStorage[fullKey] = str;
    }
    catch(e) {
      try {
        window.sessionStorage[fullKey] = str;
      }
      catch(e) {
        data[fullKey] = str;
      }
    }

    return true;
  }

}

module.exports = AekStorage;
