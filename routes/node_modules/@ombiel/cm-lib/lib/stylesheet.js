var stylesheet;

function getStylesheet() {
  if (!stylesheet) {
    var style = document.createElement("style");

    // WebKit hack :(
    style.appendChild(document.createTextNode(""));

    // Add the <style> element to the page
    document.head.appendChild(style);

    stylesheet = style.sheet;
  }
  return stylesheet;
}

module.exports = {
  addRule: function(selector,rules,index) {
    var sheet = getStylesheet();
    var pos = sheet.insertRule(`${selector}{${rules}}`,index);
    return sheet.cssRules[pos];
  },
  removeRule: function(rule) {
    var sheet = getStylesheet();
    for (var i = 0; i < sheet.cssRules.length; i++) { //eslint-disable-line no-plusplus
      if (sheet.cssRules[i] === rule) {
        sheet.deleteRule(i);
        return true;
      }
    }
    return false;
  }
};
